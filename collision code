let get_height (s : sprite) = 
  Array.length (dump_image s.img)
let get_width (s: sprite) = 
  Array.length (Array.get (dump_image s.img ) 1)

let collision_test (s: sprite) (e: sprite) = 
  if ((s.x < e.x + (get_height e)/2 && s.x > e.x - (get_height e)/2) && 
      (s.y < e.y + (get_width e)/ 2 && s.y > e.y - (get_width e)/2)) then true else false

let collision (s: sprite) (e: sprite) = 
  if (collision_test s e) then 
    if s.lives > 0 then s.lives <- s.lives - 1 else exit 0


let rec game_loop s e lasers = (* later make e a list of enemies rather than a single enemy *)
  sleepf 0.05;
  update_pos s;
  move_enemy e;
  clear_graph ();
  draw s;
  draw e;
  collision s e;
  game_loop s e lasers
